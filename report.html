<head>

<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

<script>
	function loadChart() {
		var data = {
			"tx_rt_data_new_order" : {
				"tx_rt_series" : []
			}
		};
		var xhr = new XMLHttpRequest();		
		xhr.open("GET", "data.json", true);
		xhr.overrideMimeType("application/json");
		xhr.onload = function() {
			data = JSON.parse(xhr.responseText);
			
			var new_order = data.tx_rt_data_new_order;

			var tx_rt_options = {
			  chart: {
				height: 380,
				width: "100%"
			  },
			  colors: ['#2DA5F4'],
			  series: [
				{
				  name: "NewOrder",
				  data: new_order.tx_rt_series,
				  type: "line"
				}
			  ],
			  annotations: {
				xaxis: [
				  {
					x: new_order.tx_rt_mean,
					borderColor: "#2DA5F4",
					label: {
					  borderWidth: 0,
					  style: {
						color: "#2DA5F4",
						background: "rgba(255, 255, 255, 0.8)"
					  },
					  text: "Average = " + (new_order.tx_rt_mean / 1000).toFixed(1)
					}
				  },
				  {
					x: new_order.tx_rt_p90,
					borderColor: "#2DA5F4",					
					label: {
					  borderWidth: 0,
					  style: {
						color: "#2DA5F4",
						background: "rgba(255, 255, 255, 0.8)"
					  },
					  text: "90-th Percentile = " + (new_order.tx_rt_p90 / 1000).toFixed(1)
					}
				  }
				]
			  },
			  tooltip: {
				x: {
				  formatter: function(val) {
					return (val / 1000).toFixed(1);
				  }
				}
			  },
			  dataLabels: {
				enabled: true,
				style: {
					colors: ['#333']
				},
				offsetX: 0
			  },
			  xaxis: {
				labels: {
					formatter: function (val) {
					  return (val / 1000).toFixed(1);
					}
				}
			  }
			};
			
			
			var tpm_new_order = data.throughput_data_new_order;
			var tpm_options = {
			  chart: {
				height: 380,
				width: "100%"
			  },
			  colors: ['#2DA5F4'],
			  series: [
				{
				  name: "NewOrder",
				  data: tpm_new_order.tpm_series,
				  type: "line"
				}
			  ],
			  annotations: {
				xaxis: [
				  {
					x: tpm_new_order.steady_begin_time,
					borderColor: "#00E396",
					label: {
					  //borderColor: "#00E396",
					  borderWidth: 0,
					  style: {
						color: "#00E396",
						background: "rgba(255, 255, 255, 0.8)"
					  },
					  text: "Steady Started = " + (tpm_new_order.steady_begin_time / 1000).toFixed(0)
					}
				  },
				  {
					x: tpm_new_order.steady_end_time,
					borderColor: "#00E396",					
					label: {
					  //borderColor: "#00E396",
					  borderWidth: 0,
					  style: {
						color: "#00E396",
						background: "rgba(255, 255, 255, 0.8)"
					  },
					  text: "Steady Finished = " + (tpm_new_order.steady_end_time / 1000).toFixed(0)
					}
				  }
				]
			  },	
			  tooltip: {
				x: {
				  formatter: function(val) {
					return (val / 1000).toFixed(0);
				  }
				}
			  },
			  xaxis: {
				labels: {
					formatter: function (val) {
					  return (val / 1000).toFixed(0);
					}
				}
			  }
			};


			var tx_rt_chart = new ApexCharts(
				document.querySelector("#tx_rt_chart"),
				tx_rt_options
			);

			tx_rt_chart.render();

			var tpm_chart = new ApexCharts(
				document.querySelector("#tpm_chart"),
				tpm_options
			);

			tpm_chart.render();
		}
		xhr.send();
	}
</script>
</head>
<body onload="loadChart();">
  <div id="tx_rt_chart"></div>
  <div style="padding: 20px" />
  <div id="tpm_chart"></div>
</body>